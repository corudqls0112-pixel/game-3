<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>성경 카드 게임 + 자물쇠 + 보상</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: Arial, sans-serif;
    background: #f0f8ff;
    padding: 20px;
  }
  h1, p { text-align: center; }
  .card-container {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    justify-content: center;
    margin-bottom: 20px;
  }
  .card {
    width: 200px;
    height: 120px;
    perspective: 1000px;
    cursor: grab;
  }
  .card-inner {
    width: 100%;
    height: 100%;
    transition: transform 0.6s;
    transform-style: preserve-3d;
    border-radius: 10px;
  }
  .card.flipped .card-inner { transform: rotateY(180deg); }
  .card-front, .card-back {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 10px;
    backface-visibility: hidden;
  }
  .card-front { background: #1e90ff; color: white; }
  .card-back { background: #fff; color: #333; transform: rotateY(180deg); border: 2px solid #1e90ff; }
  #nextMessage { margin-top: 20px; font-size: 1.2rem; color: green; display: none; text-align: center; }
  #lockContainer { display: none; flex-direction: column; align-items: center; margin-top: 20px; }
  #lockContainer input { padding: 5px 10px; font-size: 1rem; width: 150px; margin-bottom: 10px; }
  #rewardMessage { display: none; margin-top: 20px; font-size: 1.2rem; color: blue; text-align: center; }
</style>
</head>
<body>

<h1 id="gameTitle">성경 카드 게임</h1>
<p id="gameDesc">카드를 클릭하여 내용을 확인하고, 올바른 순서대로 정렬하세요.</p>

<div class="card-container" id="cardContainer"></div>

<div id="nextMessage"></div>

<div id="lockContainer">
  <p>모든 게임 완료! 자물쇠 비밀번호를 입력하세요.</p>
  <input type="text" id="lockInput" placeholder="비밀번호 입력">
  <button id="checkLock">확인</button>
  <p id="lockMessage"></p>
</div>

<div id="rewardMessage">축하합니다! 마지막 퍼즐 조각은 전도사님한테 있습니다!</div>

<script>
// === 게임 데이터 정의 ===
const games = [
  {
    title: "고린도전서 1:17 카드 게임",
    description: "카드를 클릭하여 내용을 확인하고, 올바른 순서대로 정렬하세요.",
    cards: [
      "그리스도께서 나를 보내심은",
      "세례를 베풀게 하려 하심이 아니요",
      "오직 복음을 전하게 하려 하심이로되",
      "말의 지혜로 하지 아니함은",
      "그리스도의 십자가가 헛되지 않게 하려 함이라"
    ]
  },
  {
    title: "시편 133:1 카드 게임",
    description: "카드를 클릭하여 내용을 확인하고, 올바른 순서대로 정렬하세요.",
    cards: [
      "보라 형제가 연합하여 동거함이",
      "얼마나 선하고",
      "얼마나 아름다운가",
      "여호와께서 그 복을 명하셨도다"
    ]
  }
];

let currentGameIndex = 0;
let correctOrder = [];
const container = document.getElementById("cardContainer");
const nextMessage = document.getElementById("nextMessage");
const gameTitle = document.getElementById("gameTitle");
const gameDesc = document.getElementById("gameDesc");
const lockContainer = document.getElementById("lockContainer");
const lockInput = document.getElementById("lockInput");
const lockMessage = document.getElementById("lockMessage");
const checkLockBtn = document.getElementById("checkLock");
const rewardMessage = document.getElementById("rewardMessage");
const PASSWORD = "11731"; // 자물쇠 비밀번호

// === 카드 생성 함수 ===
function shuffleArray(array) {
  for (let i = array.length -1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i +1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function createCards() {
  container.innerHTML = "";
  nextMessage.style.display = 'none';
  const currentGame = games[currentGameIndex];
  gameTitle.textContent = currentGame.title;
  gameDesc.textContent = currentGame.description;

  correctOrder = [...currentGame.cards];
  const shuffledTexts = shuffleArray([...currentGame.cards]);

  shuffledTexts.forEach((text, index) => {
    const card = document.createElement("div");
    card.className = "card";
    card.draggable = true;
    card.dataset.index = index;
    card.innerHTML = `
      <div class="card-inner">
        <div class="card-front">뒤집기</div>
        <div class="card-back">${text}</div>
      </div>
    `;
    card.addEventListener("click", () => card.classList.toggle("flipped"));
    card.addEventListener('dragstart', dragStart);
    card.addEventListener('dragover', dragOver);
    card.addEventListener('drop', drop);
    card.addEventListener('dragend', dragEnd);
    container.appendChild(card);
  });
}

// === 드래그 앤 드롭 ===
let dragSrcEl = null;
function dragStart(e) { dragSrcEl = this; this.style.opacity = '0.5'; }
function dragOver(e) { e.preventDefault(); }
function drop(e) {
  e.stopPropagation();
  if (dragSrcEl !== this) {
    const nodes = Array.from(container.children);
    const srcIndex = nodes.indexOf(dragSrcEl);
    const destIndex = nodes.indexOf(this);
    if (srcIndex < destIndex) container.insertBefore(dragSrcEl, this.nextSibling);
    else container.insertBefore(dragSrcEl, this);
    checkOrder();
  }
}
function dragEnd(e) { this.style.opacity = '1'; }

// === 순서 체크 ===
function checkOrder() {
  const currentOrder = Array.from(container.children)
    .map(card => card.querySelector(".card-back").textContent);
  if (currentOrder.join() === correctOrder.join()) {
    nextMessage.style.display = 'block';
    nextMessage.textContent = "정답! 잠시 후 다음 게임으로 이동합니다...";
    if (currentGameIndex + 1 < games.length) {
      setTimeout(() => {
        currentGameIndex++;
        createCards();
      }, 1000);
    } else {
      setTimeout(() => {
        nextMessage.textContent = "축하합니다! 모든 카드를 맞추셨습니다. 이제 자물쇠를 여세요.";
        lockContainer.style.display = 'flex';
      }, 1000);
    }
  } else if (currentOrder.length === correctOrder.length) {
    nextMessage.style.display = 'none';
    setTimeout(() => { alert("틀렸습니다! 카드가 다시 섞입니다."); createCards(); }, 500);
  }
}

// === 자물쇠 확인 ===
checkLockBtn.addEventListener('click', () => {
  if (lockInput.value === PASSWORD) {
    lockMessage.style.color = 'green';
    lockMessage.textContent = "정답! 자물쇠가 열렸습니다.";
    rewardMessage.style.display = 'block';
  } else {
    lockMessage.style.color = 'red';
    lockMessage.textContent = "틀렸습니다. 다시 시도하세요.";
    rewardMessage.style.display = 'none';
  }
});

// 초기 카드 생성
createCards();
</script>

</body>
</html>
