<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>성경 카드 게임 + 제출 + 자물쇠 + 힌트</title>
<style>
  body {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: Arial, sans-serif;
    background: #f0f8ff;
    padding: 20px;
    margin: 0;
  }
  h1, p { text-align: center; margin: 5px 0; }
  .card-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
  }
  .card {
    flex: 1 1 150px;
    max-width: 220px;
    min-width: 140px;
    height: 120px;
    cursor: grab;
    border: 2px solid #1e90ff;
    border-radius: 10px;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 10px;
    user-select: none;
    box-sizing: border-box;
    transition: transform 0.2s;
  }
  #submitBtn, #hintBtn, #checkLock {
    padding: 10px 20px;
    font-size: 1rem;
    margin: 10px;
    cursor: pointer;
  }
  #nextMessage { margin-top: 20px; font-size: 1.2rem; color: green; text-align: center; display: none; }
  #lockContainer { display: none; flex-direction: column; align-items: center; margin-top: 20px; }
  #lockContainer input { padding: 5px 10px; font-size: 1rem; width: 150px; margin-bottom: 10px; }
  #hintMessage {
    color: #d2691e;
    margin-bottom: 10px;
    text-align: center;
    opacity: 0;
    transition: opacity 0.5s;
    pointer-events: none;
  }
  #rewardMessage { display: none; margin-top: 20px; font-size: 1.2rem; color: blue; text-align: center; }
  @media (max-width: 600px) {
    .card {
      flex: 1 1 45%;
      min-width: 120px;
      height: 100px;
      font-size: 0.9rem;
    }
  }
</style>
</head>
<body>

<h1 id="gameTitle">성경 카드 게임</h1>
<p id="gameDesc">카드를 원하는 순서로 드래그하여 나열하고 제출하세요.</p>

<div class="card-container" id="cardContainer"></div>
<button id="submitBtn">제출</button>

<div id="nextMessage"></div>

<div id="lockContainer">
  <p>모든 게임 완료! 자물쇠 비밀번호를 입력하세요.</p>
  <input type="text" id="lockInput" placeholder="비밀번호 입력">
  <div>
    <button id="checkLock">확인</button>
    <button id="hintBtn">힌트</button>
  </div>
  <p id="hintMessage">힌트: 지금까지 이어 붙인 성경 말씀의 장과 절이 비밀번호를 푸는 열쇠입니다.</p>
  <p id="lockMessage"></p>
</div>

<div id="rewardMessage">축하합니다! 마지막 퍼즐 조각은 전도사님한테 있습니다!</div>

<script>
// === 게임 데이터 정의 ===
const games = [
  {
    title: "말씀 이어붙이기 게임",
    description: "카드를 원하는 순서로 드래그하여 나열하고 제출하세요.",
    cards: [
      "그리스도께서 나를 보내심은",
      "세례를 베풀게 하려 하심이 아니요",
      "오직 복음을 전하게 하려 하심이로되",
      "말의 지혜로 하지 아니함은",
      "그리스도의 십자가가 헛되지 않게 하려 함이라"
    ]
  },
  {
    title: "말씀 이어붙이기 게임",
    description: "카드를 원하는 순서로 드래그하여 나열하고 제출하세요.",
    cards: [
      "보라 형제가 연합하여 동거함이",
      "얼마나 선하고",
      "얼마나 아름다운가",
      "여호와께서 그 복을 명하셨도다"
    ]
  }
];

let currentGameIndex = 0;
let correctOrder = [];
let currentCards = [];
const container = document.getElementById("cardContainer");
const nextMessage = document.getElementById("nextMessage");
const gameTitle = document.getElementById("gameTitle");
const gameDesc = document.getElementById("gameDesc");
const submitBtn = document.getElementById("submitBtn");
const lockContainer = document.getElementById("lockContainer");
const lockInput = document.getElementById("lockInput");
const lockMessage = document.getElementById("lockMessage");
const checkLockBtn = document.getElementById("checkLock");
const rewardMessage = document.getElementById("rewardMessage");
const hintBtn = document.getElementById("hintBtn");
const hintMessage = document.getElementById("hintMessage");
const PASSWORD = "11731";

// === 카드 생성 ===
function shuffleArray(array) {
  for (let i = array.length -1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i +1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function createCards() {
  container.innerHTML = "";
  nextMessage.style.display = 'none';
  const currentGame = games[currentGameIndex];
  gameTitle.textContent = currentGame.title;
  gameDesc.textContent = currentGame.description;

  correctOrder = [...currentGame.cards];
  const shuffledTexts = shuffleArray([...currentGame.cards]);
  currentCards = [];

  shuffledTexts.forEach(text => {
    const card = document.createElement("div");
    card.className = "card";
    card.draggable = true;
    card.textContent = text;
    addDragEvents(card);
    container.appendChild(card);
    currentCards.push(card);
  });
}

// === 드래그 ===
let dragSrcEl = null;
function addDragEvents(card) {
  card.addEventListener('dragstart', dragStart);
  card.addEventListener('dragover', dragOver);
  card.addEventListener('drop', drop);
  card.addEventListener('dragend', dragEnd);

  // 모바일 터치 드래그
  card.addEventListener('touchstart', touchStart, {passive: false});
  card.addEventListener('touchmove', touchMove, {passive: false});
  card.addEventListener('touchend', touchEnd);
}
function dragStart(e) { dragSrcEl = this; this.style.opacity = '0.5'; }
function dragOver(e) { e.preventDefault(); }
function drop(e) {
  e.stopPropagation();
  if (dragSrcEl !== this) {
    const nodes = Array.from(container.children);
    const srcIndex = nodes.indexOf(dragSrcEl);
    const destIndex = nodes.indexOf(this);
    if (srcIndex < destIndex) container.insertBefore(dragSrcEl, this.nextSibling);
    else container.insertBefore(dragSrcEl, this);
  }
}
function dragEnd(e) { this.style.opacity = '1'; }

// === 모바일 터치 스와이프 드래그 ===
let touchStartY = 0;
let touchStartX = 0;
let touchCard = null;

function touchStart(e) {
  e.preventDefault();
  touchCard = this;
  touchCard.style.opacity = '0.5';
  touchStartY = e.touches[0].clientY;
  touchStartX = e.touches[0].clientX;
}
function touchMove(e) {
  e.preventDefault();
  const touchY = e.touches[0].clientY;
  const touchX = e.touches[0].clientX;
  const nodes = Array.from(container.children).filter(c => c !== touchCard);
  nodes.forEach(node => {
    const rect = node.getBoundingClientRect();
    if (touchY > rect.top && touchY < rect.bottom && touchX > rect.left && touchX < rect.right) {
      container.insertBefore(touchCard, node);
    }
  });
}
function touchEnd(e) {
  if (touchCard) touchCard.style.opacity = '1';
  touchCard = null;
}

// === 제출 버튼 ===
submitBtn.addEventListener('click', () => {
  const currentOrder = Array.from(container.children).map(card => card.textContent);
  if (currentOrder.join() === correctOrder.join()) {
    nextMessage.style.display = 'block';
    nextMessage.textContent = "정답! 잠시 후 다음 게임으로 이동합니다...";
    if (currentGameIndex + 1 < games.length) {
      setTimeout(() => { currentGameIndex++; createCards(); }, 1000);
    } else {
      setTimeout(() => {
        nextMessage.textContent = "축하합니다! 모든 카드를 맞추셨습니다. 이제 자물쇠를 여세요.";
        lockContainer.style.display = 'flex';
      }, 1000);
    }
  } else {
    alert("틀렸습니다! 카드가 다시 섞입니다.");
    const texts = currentCards.map(c => c.textContent);
    const shuffled = shuffleArray([...texts]);
    currentCards.forEach((card, i) => card.textContent = shuffled[i]);
  }
});

// === 자물쇠 확인 ===
checkLockBtn.addEventListener('click', () => {
  if (lockInput.value === PASSWORD) {
    lockMessage.style.color = 'green';
    lockMessage.textContent = "정답! 자물쇠가 열렸습니다.";
    rewardMessage.style.display = 'block';
  } else {
    lockMessage.style.color = 'red';
    lockMessage.textContent = "틀렸습니다. 다시 시도하세요.";
    rewardMessage.style.display = 'none';
  }
});

// === 힌트 버튼 ===
hintBtn.addEventListener('click', () => {
  hintMessage.style.opacity = '1';
  setTimeout(() => { hintMessage.style.opacity = '0'; }, 3000);
});

// 초기 카드 생성
createCards();
</script>

</body>
</html>
